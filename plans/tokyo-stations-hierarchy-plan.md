# 東京車站父子節點設計方案

## 設計原則

### 節點類型定義
| 類型 | is_hub | parent_hub_id | 顯示行為 |
|------|--------|---------------|----------|
| Hub（樞紐站） | true | null | ✅ 顯示在地圖上，標記換乘資訊 |
| Child（子站） | false | 有值 | ❌ 隱藏在地圖上，只在 L2 頁面顯示 |
| Standalone（獨立站） | false | null | ✅ 顯示在地圖上 |

### Hub 定義標準
1. **多線共構**：有 3 條以上線路停靠的車站
2. **跨公司換乘**：不同公司經營的線路在此換乘
3. **重要轉乘點**：換乘人次排名前 30 的車站

---

## 一、JR 東日本主要樞紐站（Hub）

### 山手線核心區
| 車站 | 中文 | 英文 | 共構線路 | 子站 |
|------|------|------|----------|------|
| 上野 | 上野 | Ueno | JR山手線、東北線、上越線、京濱東北線、東京Metro銀座線、日比谷線 | 東京Metro上野、京成上野 |
| 秋葉原 | 秋葉原 | Akihabara | JR山手線、京濱東北線、總武線、東京Metro日比谷線、筑波快線 | 筑波快線秋葉原 |
| 東京 | 東京 | Tokyo | JR山手線、京濱東北線、東海道線、中央線、總武線、東京Metro丸之內線、東西線 | 東京Metro大手町 |
| 品川 | 品川 | Shinagawa | JR山手線、京濱東北線、東海道線、横須賀線、京濱急行電鐵 | - |
| 澀谷 | 渋谷 | Shibuya | JR山手線、湘南新宿線、東京Metro銀座線、半藏門線、東急東横線、田園都市線、京王井之頭線 | 東京Metro澀谷 |
| 新宿 | 新宿 | Shinjuku | JR山手線、中央線、湘南新宿線、小田急電鐵、京王電鐵、東京Metro丸之內線、都營大江戶線、都營新宿線 | 東京Metro新宿 |
| 池袋 | 池袋 | Ikebukuro | JR山手線、湘南新宿線、東武電鐵、西武電鐵、東京Metro有樂町線、丸之內線 | 東京Metro池袋 |
| 北品川 | 北品川 | Kita-Shinagawa | JR京濱東北線 | - |
| 大崎 | 大崎 | Osaki | JR山手線、湘南新宿線、東急電鐵 | - |

### 中央線・總武線區域
| 車站 | 中文 | 英文 | 共構線路 | 子站 |
|------|------|------|----------|------|
| 御茶之水 | 御茶ノ水 | Ochanomizu | JR中央線、總武線、東京Metro丸之內線 | - |
| 神田 | 神田 | Kanda | JR山手線、京濱東北線、中央線、東京Metro銀座線 | 東京Metro神田 |
| 飯田橋 | 飯田橋 | Iidabashi | JR中央線、總武線、東京Metro有樂町線、東西線、都營大江戶線 | 東京Metro飯田橋 |
| 四谷 | 四ツ谷 | Yotsuya | JR中央線、總武線、東京Metro丸之內線、南北線 | - |
| 市谷 | 市ヶ谷 | Ichigaya | JR中央線、總武線、都營新宿線、都營大江戶線 | - |
| 九段下 | 九段下 | Kudanshita | JR中央線、總武線、都營新宿線、東京Metro東西線 | - |
| 水道橋 | 水道橋 | Suidobashi | JR中央線、總武線 | - |
| 船橋 | 船橋 | Funabashi | JR總武線、東武野田線、京成電鐵 | - |
| 津田沼 | 津田沼 | Tsudanuma | JR總武線、東武野田線 | - |

---

## 二、東京地下鐵（Tokyo Metro）樞紐站

### 銀座線核心
| 車站 | 中文 | 英文 | 共構線路 | 子站 |
|------|------|------|----------|------|
| 淺草 | 浅草 | Asakusa | 東京Metro銀座線、都營淺草線、東武晴空塔線、筑波快線 | - |
| 銀座 | 銀座 | Ginza | 東京Metro銀座線、丸之內線、日比谷線 | - |
| 新橋 | 新橋 | Shimbashi | 東京Metro銀座線、JR山手線、京濱東北線、東海道線 | - |
| 上野 | 上野 | Ueno | 東京Metro銀座線、JR山手線 | JR上野、京成上野 |

### 日比谷線核心
| 車站 | 中文 | 英文 | 共構線路 | 子站 |
|------|------|------|----------|------|
| 中目黑 | 中目黒 | Naka-Meguro | 東京Metro日比谷線、東急東横線 | - |
| 恵比壽 | 恵比寿 | Ebisu | 東京Metro日比谷線、JR山手線 | - |
| 、自由之丘 | 自由が丘 | Jiyugaoka | 東京Metro日比谷線、東急電鐵 | - |

### 東西線核心
| 車站 | 中文 | 英文 | 共構線路 | 子站 |
|------|------|------|----------|------|
| 日本橋 | 日本橋 | Nihombashi | 東京Metro東西線、都營淺草線 | 都營日本橋 |
| 大手町 | 大手町 | Otemachi | 東京Metro東西線、丸之內線、半藏門線、都營三田線 | JR東京 |
| 竹橋 | 竹橋 | Takebashi | 東京Metro東西線 | - |
| 九段下 | 九段下 | Kudanshita | 東京Metro東西線、JR中央線、都營新宿線 | - |

### 有樂町線核心
| 車站 | 中文 | 英文 | 共構線路 | 子站 |
|------|------|------|----------|------|
| 池袋 | 池袋 | Ikebukuro | 東京Metro有樂町線、丸之內線、JR山手線 | JR池袋 |
| 飯田橋 | 飯田橋 | Iidabashi | 東京Metro有樂町線、東西線、JR中央線、都營大江戶線 | JR飯田橋 |
| 永代橋 | 永代橋 | Edogawabashi | 東京Metro有樂町線 | - |

### 半藏門線核心
| 車站 | 中文 | 英文 | 共構線路 | 子站 |
|------|------|------|----------|------|
| 澀谷 | 渋谷 | Shibuya | 東京Metro半藏門線、JR山手線、東急電鐵 | JR澀谷 |
| 表參道 | 表参道 | Omotesando | 東京Metro半藏門線、銀座線 | - |
| 青山一丁目 | 青山一丁目 | Aoyama-itchome | 東京Metro半藏門線、銀座線、都營大江戶線 | - |

---

## 三、都營地下鐵（Toei）樞紐站

### 淺草線核心
| 車站 | 中文 | 英文 | 共構線路 | 子站 |
|------|------|------|----------|------|
| 淺草 | 浅草 | Asakusa | 都營淺草線、東京Metro銀座線、東武晴空塔線、筑波快線 | - |
| 日本橋 | 日本橋 | Nihombashi | 都營淺草線、東京Metro東西線 | 東京Metro日本橋 |
| 東日本橋 | 東日本橋 | Higashi-Nihombashi | 都營淺草線、都營新宿線 | 馬喰橫山 |
| 大門 | 大門 | Daimon | 都營淺草線、JR山手線、京濱東北線、都營大江戶線 | JR濱松町 |
| 三田 | 三田 | Mita | 都營三田線、都營淺草線、東京Metro南北線 | - |

### 新宿線核心
| 車站 | 中文 | 英文 | 共構線路 | 子站 |
|------|------|------|----------|------|
| 新宿 | 新宿 | Shinjuku | 都營新宿線、JR山手線、東京Metro丸之內線 | JR新宿 |
| 市谷 | 市ヶ谷 | Ichigaya | 都營新宿線、JR中央線、都營大江戶線 | - |
| 九段下 | 九段下 | Kudanshita | 都營新宿線、JR中央線、東京Metro東西線 | - |
| 神保町 | 神保町 | Jimbocho | 都營新宿線、東京Metro半藏門線 | - |
| 馬喰橫山 | 馬喰横山 | Bakuro-Yokoyama | 都營新宿線、都營淺草線 | 東日本橋 |

### 大江戶線核心
| 車站 | 中文 | 英文 | 共構線路 | 子站 |
|------|------|------|----------|------|
| 新宿 | 新宿 | Shinjuku | 都營大江戶線、JR山手線 | JR新宿 |
| 青山一丁目 | 青山一丁目 | Aoyama-itchome | 都營大江戶線、東京Metro半藏門線 | - |
| 飯田橋 | 飯田橋 | Iidabashi | 都營大江戶線、JR中央線、東京Metro有樂町線 | JR飯田橋 |
| 春日 | 春日 | Kasuga | 都營大江戶線、都營三田線 | - |
| 藏前 | 蔵前 | Kuramae | 都營大江戶線、都營淺草線 | - |
| 築地市場 | 築地市場 | Tsukijishijo | 都營大江戶線 | - |
| 月島 | 月島 | Tsukishima | 都營大江戶線、東京Metro有樂町線 | - |
| 勝鬨 | 勝どき | Kachidoki | 都營大江戶線 | - |

---

## 四、私鐵樞紐站

| 車站 | 營運商 | 換乘線路 |
|------|--------|----------|
| 品川 | 京濱急行 | 與 JR 品川換乘 |
| 押上 | 東武晴空塔線、筑波快線 | 與東京Metro半藏門線換乘 |
| 淺草 | 東武晴空塔線 | 與都營淺草線、東京Metro銀座線換乘 |
| 青砥 | 京濱急行、北總鐵道 | 與京成電鐵換乘 |
| 京成上野 | 京成電鐵 | 與 JR 上野、東京Metro上野換乘 |

---

## 五、完整分類清單

### A. 樞紐站（Hub）- 預計 50-70 個
```
上野、秋葉原、東京、品川、澀谷、新宿、池袋、
御茶之水、神田、飯田橋、四谷、市谷、九段下、水道橋、
淺草、銀座、新橋、日本橋、大門、三田、新宿（都營）、
市谷（都營）、九段下（都營）、神保町、馬喰橫山、
青山一丁目、大手町、竹橋、永代橋、恵比壽、自由之丘、
中目黑、表參道、押上、青砥、京成上野、北品川、大崎、
船橋、津田沼、春日、藏前、築地市場、月島、勝鬨、
春日（都營三田線）、白金高輪、白金台、麻布十番、
六本木、赤坂見附、永福町、下北澤、代代木上原、
高田馬場、早稻田、神樂坂、傳通院前、學習院下
```

### B. 子站（Child）- 預計 20-30 個
```
東京Metro上野 → JR上野
東京Metro大手町 → JR東京
東京Metro新宿 → JR新宿
東京Metro池袋 → JR池袋
東京Metro澀谷 → JR澀谷
東京Metro日本橋 → 都營日本橋
東京Metro飯田橋 → JR飯田橋
東京Metro神田 → JR神田
筑波快線秋葉原 → JR秋葉原
京成上野 → JR上野
都營日本橋 → 東京Metro日本橋
馬喰橫山 → 都營東日本橋
JR濱松町 → 都營大門
```

### C. 獨立站（Standalone）- 其餘車站
所有不在 A 或 B 清單中的車站都是獨立站。

---

## 六、實施工單

### Phase 1: 資料庫清理
- [ ] 執行 `20260103_complete_node_fix.sql` migration
- [ ] 驗證 `nodes` 表中的 `is_hub` 和 `parent_hub_id` 欄位

### Phase 2: 擴展 Hub 清單
- [ ] 新增缺失的 Hub 站（如品川、早稻田、高田馬場等）
- [ ] 建立完整的父子節點對應關係
- [ ] 更新 seedNodes.ts

### Phase 3: 驗證與測試
- [ ] 測試上野區域的父子節點顯示
- [ ] 測試東京站區域的父子節點顯示
- [ ] 測試品川站是否正確顯示

---

## 備註

1. **Hub 數量估算**：東京核心區（23區）約有 50-70 個主要樞紐站
2. **父子關係**：原則上 JR 站為 Hub，其他公司站為 Child
3. **例外情況**：淺草站（都營為主 Hub）、押上站（東武為主 Hub）等

需要用戶確認：
1. 這個清單是否完整？
2. 是否有需要調整的父子關係？
3. 優先處理哪些區域？
